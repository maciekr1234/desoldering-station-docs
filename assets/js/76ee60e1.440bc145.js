"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[3030],{8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var r=n(6540);const i={},a=r.createContext(i);function s(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:t},e.children)}},9449:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"gui/temp-calibration","title":"Temperature Calibration","description":"Guided wizard for calibrating temperature sensor readings.","source":"@site/docs/gui/temp-calibration.md","sourceDirName":"gui","slug":"/gui/temp-calibration","permalink":"/desoldering-station-docs/docs/gui/temp-calibration","draft":false,"unlisted":false,"editUrl":"https://github.com/maciekr1234/desoldering-station/tree/master/docs-site/docs/gui/temp-calibration.md","tags":[],"version":"current","lastUpdatedAt":1764813213000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Menu Helpers","permalink":"/desoldering-station-docs/docs/gui/menu-helpers"},"next":{"title":"API Reference","permalink":"/desoldering-station-docs/docs/api"}}');var i=n(4848),a=n(8453);const s={sidebar_position:5},l="Temperature Calibration",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Usage",id:"usage",level:2},{value:"Calibration Methods",id:"calibration-methods",level:2},{value:"Wizard Mode (Recommended)",id:"wizard-mode-recommended",level:3},{value:"Manual Entry Mode",id:"manual-entry-mode",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"<code>create_temp_calibration_subpage</code>",id:"create_temp_calibration_subpage",level:3},{value:"State Machine",id:"state-machine",level:2},{value:"States",id:"states",level:3},{value:"Calibration Process",id:"calibration-process",level:2},{value:"Calibration Points",id:"calibration-points",level:2},{value:"Timing Parameters",id:"timing-parameters",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Timeout",id:"timeout",level:3},{value:"Cancel",id:"cancel",level:3},{value:"Input Validation",id:"input-validation",level:3},{value:"Integration",id:"integration",level:2},{value:"HeaterController Methods Used",id:"heatercontroller-methods-used",level:3},{value:"Temperature Reading",id:"temperature-reading",level:3},{value:"Settings Structure",id:"settings-structure",level:3},{value:"Source Files",id:"source-files",level:2}];function o(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"temperature-calibration",children:"Temperature Calibration"})}),"\n",(0,i.jsx)(t.p,{children:"Guided wizard for calibrating temperature sensor readings."}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"The temperature calibration module provides a step-by-step wizard for calibrating the heater temperature sensor at 6 fixed points (100\xb0C, 200\xb0C, 300\xb0C, 350\xb0C, 400\xb0C, 450\xb0C). Users compare the displayed temperature against an external reference thermometer and enter the actual measured values."}),"\n",(0,i.jsx)(t.h2,{id:"features",children:"Features"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Preview of current calibration values before starting"}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Two calibration methods:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Wizard Mode"})," \u2014 Guided step-by-step with automatic heating and stability detection"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Manual Entry"})," \u2014 Direct offset input without heating (for users who already know their offsets)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.li,{children:"Real-time temperature display during calibration"}),"\n",(0,i.jsx)(t.li,{children:"Stability detection (\xb15\xb0C for 2 seconds) before allowing input"}),"\n",(0,i.jsx)(t.li,{children:"5-minute timeout per step with automatic cooldown"}),"\n",(0,i.jsx)(t.li,{children:"Cancel confirmation dialog"}),"\n",(0,i.jsx)(t.li,{children:"Input validation (target \xb150\xb0C range)"}),"\n",(0,i.jsx)(t.li,{children:"Results summary with Save/Start Over/Exit options"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(t.p,{children:"Include the header in your settings screen:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:'#include "gui/extra/temp_calibration.h"\n'})}),"\n",(0,i.jsx)(t.p,{children:"Register as a subpage in your menu:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:'create_subpage(section, "Temperature Calibration", create_temp_calibration_subpage);\n'})}),"\n",(0,i.jsx)(t.h2,{id:"calibration-methods",children:"Calibration Methods"}),"\n",(0,i.jsx)(t.h3,{id:"wizard-mode-recommended",children:"Wizard Mode (Recommended)"}),"\n",(0,i.jsx)(t.p,{children:"The guided wizard heats to each calibration point, waits for stability, and prompts for the actual measured temperature from an external reference thermometer."}),"\n",(0,i.jsx)(t.h3,{id:"manual-entry-mode",children:"Manual Entry Mode"}),"\n",(0,i.jsxs)(t.p,{children:["For users who already know their calibration offsets (e.g., from a previous calibration or datasheet), the ",(0,i.jsx)(t.strong,{children:"Manual Entry"})," option allows direct input of all 6 offset values without waiting for the heater to reach temperature."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Click ",(0,i.jsx)(t.strong,{children:'"Manual Entry"'})," on the calibration start screen"]}),"\n",(0,i.jsx)(t.li,{children:"Enter the offset values for each temperature point (100\xb0C through 450\xb0C)"}),"\n",(0,i.jsxs)(t.li,{children:["Click ",(0,i.jsx)(t.strong,{children:'"Save"'})," to apply the values, or ",(0,i.jsx)(t.strong,{children:'"Back"'})," to cancel"]}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{title:"When to Use Manual Entry",type:"tip",children:(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Re-entering previously known calibration values"}),"\n",(0,i.jsx)(t.li,{children:"Testing different offset configurations quickly"}),"\n",(0,i.jsx)(t.li,{children:"When external reference thermometer is not available but approximate values are known"}),"\n"]})}),"\n",(0,i.jsx)(t.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,i.jsx)(t.h3,{id:"create_temp_calibration_subpage",children:(0,i.jsx)(t.code,{children:"create_temp_calibration_subpage"})}),"\n",(0,i.jsx)(t.p,{children:"Create the temperature calibration page for use as a subpage in a settings menu."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:"lv_obj_t* create_temp_calibration_subpage(lv_obj_t* menu);\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"menu"})," \u2014 Parent settings menu object"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Returns:"})," Pointer to the created page"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"state-machine",children:"State Machine"}),"\n",(0,i.jsx)(t.p,{children:"The calibration wizard operates as a state machine:"}),"\n",(0,i.jsx)(t.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Idle: Page opened\n\n    Idle --\x3e Heating: Start Calibration clicked\n    \n    Heating --\x3e Stabilizing: Temperature within \xb15\xb0C\n    Stabilizing --\x3e Heating: Temperature drifts outside \xb15\xb0C\n    Stabilizing --\x3e WaitingInput: Stable for 2 seconds\n    \n    WaitingInput --\x3e Heating: Confirm clicked\\n(next step)\n    WaitingInput --\x3e Complete: Confirm clicked\\n(step 6 done)\n    \n    Heating --\x3e Timeout: 5 minutes elapsed\n    Stabilizing --\x3e Timeout: 5 minutes elapsed\n    WaitingInput --\x3e Timeout: 5 minutes elapsed\n    \n    Timeout --\x3e [*]: Heater off, exit after 2s\n    \n    Heating --\x3e [*]: Cancel confirmed\n    Stabilizing --\x3e [*]: Cancel confirmed\n    WaitingInput --\x3e [*]: Cancel confirmed\n    \n    Complete --\x3e Idle: Start Over clicked\n    Complete --\x3e [*]: Save clicked\n    Complete --\x3e [*]: Exit clicked"}),"\n",(0,i.jsx)(t.h3,{id:"states",children:"States"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"State"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Idle"})}),(0,i.jsx)(t.td,{children:"Showing current calibration values and Start button"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Heating"})}),(0,i.jsx)(t.td,{children:"Heating toward target temperature"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Stabilizing"})}),(0,i.jsx)(t.td,{children:"Temperature within range, waiting for stability"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"WaitingInput"})}),(0,i.jsx)(t.td,{children:"Stable, input enabled for user entry"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Complete"})}),(0,i.jsx)(t.td,{children:"All steps done, showing results"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"Timeout"})}),(0,i.jsx)(t.td,{children:"Timeout occurred, cooling down"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"calibration-process",children:"Calibration Process"}),"\n",(0,i.jsx)(t.mermaid,{value:'sequenceDiagram\n    participant User\n    participant UI as Calibration UI\n    participant Heater as HeaterController\n    participant Settings as gSettings\n\n    User->>UI: Open Temperature Calibration\n    UI->>UI: Show current values preview\n    \n    User->>UI: Click "Start Calibration"\n    UI->>Heater: changeState(Tuning)\n    UI->>Heater: setTargetTemperature(100)\n    UI->>UI: Create 200ms timer\n    \n    loop For each step (100, 200, 300, 350, 400, 450\xb0C)\n        UI->>UI: Display "Heating..."\n        \n        loop Until stable\n            UI->>UI: Timer: Read temperature\n            UI->>UI: Check \xb15\xb0C threshold\n        end\n        \n        UI->>UI: Display "Stabilizing..."\n        \n        loop 2 seconds\n            UI->>UI: Timer: Verify stability\n        end\n        \n        UI->>UI: Display "Ready"\n        UI->>UI: Enable input & Confirm\n        \n        User->>UI: Enter measured temperature\n        User->>UI: Click "Confirm"\n        UI->>UI: Store value, advance step\n        UI->>Heater: setTargetTemperature(next)\n    end\n    \n    UI->>Heater: changeState(Off)\n    UI->>UI: Show results summary\n    \n    alt Save\n        User->>UI: Click "Save"\n        UI->>Settings: Update calibration values\n        UI->>Settings: save_global_settings()\n        UI->>UI: Show "Saved!" toast\n    else Exit\n        User->>UI: Click "Exit"\n    end\n    \n    UI->>UI: Return to menu'}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"calibration-points",children:"Calibration Points"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Step"}),(0,i.jsx)(t.th,{children:"Target Temperature"}),(0,i.jsx)(t.th,{children:"Input Range"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"1"}),(0,i.jsx)(t.td,{children:"100\xb0C"}),(0,i.jsx)(t.td,{children:"50-150\xb0C"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"2"}),(0,i.jsx)(t.td,{children:"200\xb0C"}),(0,i.jsx)(t.td,{children:"150-250\xb0C"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"3"}),(0,i.jsx)(t.td,{children:"300\xb0C"}),(0,i.jsx)(t.td,{children:"250-350\xb0C"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"4"}),(0,i.jsx)(t.td,{children:"350\xb0C"}),(0,i.jsx)(t.td,{children:"300-400\xb0C"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"5"}),(0,i.jsx)(t.td,{children:"400\xb0C"}),(0,i.jsx)(t.td,{children:"350-450\xb0C"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"6"}),(0,i.jsx)(t.td,{children:"450\xb0C"}),(0,i.jsx)(t.td,{children:"400-500\xb0C"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"timing-parameters",children:"Timing Parameters"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Parameter"}),(0,i.jsx)(t.th,{children:"Value"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"STABILITY_THRESHOLD"})}),(0,i.jsx)(t.td,{children:"\xb15\xb0C"}),(0,i.jsx)(t.td,{children:"Temperature must be within this range of target"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"STABILITY_DURATION_MS"})}),(0,i.jsx)(t.td,{children:"2000ms"}),(0,i.jsx)(t.td,{children:"Time temperature must remain stable"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"CALIBRATION_TIMEOUT_MS"})}),(0,i.jsx)(t.td,{children:"5 minutes"}),(0,i.jsx)(t.td,{children:"Maximum time allowed per step"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Cooldown Delay"}),(0,i.jsx)(t.td,{children:"2 seconds"}),(0,i.jsx)(t.td,{children:"Delay before exit after timeout"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Timer Interval"}),(0,i.jsx)(t.td,{children:"200ms"}),(0,i.jsx)(t.td,{children:"UI update frequency during calibration"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(t.h3,{id:"timeout",children:"Timeout"}),"\n",(0,i.jsx)(t.p,{children:"If temperature doesn't stabilize within 5 minutes, the heater is turned off and the user is returned to the menu after a 2-second cooldown message."}),"\n",(0,i.jsx)(t.h3,{id:"cancel",children:"Cancel"}),"\n",(0,i.jsx)(t.p,{children:"User can cancel at any time via the Cancel button. A confirmation dialog prevents accidental cancellation. All progress is lost on cancel."}),"\n",(0,i.jsx)(t.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,i.jsxs)(t.p,{children:["Measured temperature input is clamped to target \xb150\xb0C (",(0,i.jsx)(t.code,{children:"INPUT_RANGE"}),") to prevent obvious entry errors."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"integration",children:"Integration"}),"\n",(0,i.jsx)(t.h3,{id:"heatercontroller-methods-used",children:"HeaterController Methods Used"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:"// Enter calibration mode\ngHeater.changeState(HeaterState::Tuning);\n\n// Stop heater (return to sleep)\ngHeater.changeState(HeaterState::Sleep);\n\n// Set target temperature for current step\ngHeater.setTargetTemperature(uint16_t temp);\n"})}),"\n",(0,i.jsx)(t.h3,{id:"temperature-reading",children:"Temperature Reading"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:"// Get filtered heater temperature\nfloat read_heater_temperature_filtered();\n"})}),"\n",(0,i.jsx)(t.h3,{id:"settings-structure",children:"Settings Structure"}),"\n",(0,i.jsxs)(t.p,{children:["Calibration values are stored in ",(0,i.jsx)(t.code,{children:"gSettings.heater.calibration"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cpp",children:"gSettings.heater.calibration.at100  // Measured temp at 100\xb0C target\ngSettings.heater.calibration.at200  // Measured temp at 200\xb0C target\ngSettings.heater.calibration.at300  // Measured temp at 300\xb0C target\ngSettings.heater.calibration.at350  // Measured temp at 350\xb0C target\ngSettings.heater.calibration.at400  // Measured temp at 400\xb0C target\ngSettings.heater.calibration.at450  // Measured temp at 450\xb0C target\n"})}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"source-files",children:"Source Files"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"File"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"include/gui/extra/temp_calibration.h"})}),(0,i.jsx)(t.td,{children:"Header with public API"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"src/gui/extra/temp_calibration.cpp"})}),(0,i.jsx)(t.td,{children:"Implementation"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);