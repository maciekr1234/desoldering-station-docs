"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[3873],{8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(6540);const r={},d=i.createContext(r);function s(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(d.Provider,{value:n},e.children)}},8633:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"configuration","title":"Configuration","description":"Hardware pin definitions, RTOS task configurations, and build settings.","source":"@site/docs/configuration.md","sourceDirName":".","slug":"/configuration","permalink":"/desoldering-station-docs/docs/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/maciekr1234/desoldering-station/tree/master/docs-site/docs/configuration.md","tags":[],"version":"current","lastUpdatedAt":1764813213000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Architecture","permalink":"/desoldering-station-docs/docs/architecture"},"next":{"title":"PID Calibration Guide","permalink":"/desoldering-station-docs/docs/pid-calibration"}}');var r=t(4848),d=t(8453);const s={sidebar_position:3},l="Configuration",c={},o=[{value:"Pin Definitions",id:"pin-definitions",level:2},{value:"Heater &amp; Temperature",id:"heater--temperature",level:3},{value:"Heater Safety Thresholds",id:"heater-safety-thresholds",level:2},{value:"Pump &amp; Motor",id:"pump--motor",level:3},{value:"Display (SPI)",id:"display-spi",level:3},{value:"Encoder",id:"encoder",level:3},{value:"Motion Sensor",id:"motion-sensor",level:3},{value:"RTOS Task Configuration",id:"rtos-task-configuration",level:2},{value:"Settings Structure",id:"settings-structure",level:2},{value:"Settings Persistence",id:"settings-persistence",level:2},{value:"Build Configuration",id:"build-configuration",level:2},{value:"PlatformIO Environment",id:"platformio-environment",level:3},{value:"Build Commands",id:"build-commands",level:3},{value:"PWM Configuration",id:"pwm-configuration",level:2},{value:"ADC Configuration",id:"adc-configuration",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,r.jsx)(n.p,{children:"Hardware pin definitions, RTOS task configurations, and build settings."}),"\n",(0,r.jsx)(n.h2,{id:"pin-definitions",children:"Pin Definitions"}),"\n",(0,r.jsxs)(n.p,{children:["All GPIO assignments are defined in ",(0,r.jsx)(n.code,{children:"include/config.h"}),":"]}),"\n",(0,r.jsx)(n.h3,{id:"heater--temperature",children:"Heater & Temperature"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pin"}),(0,r.jsx)(n.th,{children:"GPIO"}),(0,r.jsx)(n.th,{children:"Function"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_HEATER_PWM_PIN"})}),(0,r.jsx)(n.td,{children:"6"}),(0,r.jsx)(n.td,{children:"Heater PWM output"}),(0,r.jsx)(n.td,{children:"20Hz PWM for SSR"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_TEMP_ADC_PIN"})}),(0,r.jsx)(n.td,{children:"26"}),(0,r.jsx)(n.td,{children:"Thermocouple ADC"}),(0,r.jsx)(n.td,{children:"ADC0 channel"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"heater-safety-thresholds",children:"Heater Safety Thresholds"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",metastring:'title="include/config.h"',children:"#define CONFIG_HEATER_PWM_FREQUENCY_HZ      20              // PWM frequency (Hz)\n#define CONFIG_HEATER_OVERTEMP_THRESHOLD    480   // \xb0C - trigger error above this\n#define CONFIG_HEATER_SENSOR_MIN_TEMP       -50   // \xb0C - below this = sensor failure\n#define CONFIG_HEATER_SENSOR_MAX_TEMP       600   // \xb0C - above this = sensor failure\n#define CONFIG_HEATER_NO_HANDLE_TEMP        (-1000) // Temperature when no handle connected\n#define CONFIG_HEATER_RUNAWAY_RATE          50    // \xb0C/second - max allowed rise rate\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Configurable Timeouts",type:"note",children:(0,r.jsxs)(n.p,{children:["Heating, standby, and sleep timeouts are now configurable via the settings menu. The values are stored in ",(0,r.jsx)(n.code,{children:"gSettings.heater.heating_timeout_ms"}),", ",(0,r.jsx)(n.code,{children:"gSettings.heater.standby_timeout_ms"}),", and ",(0,r.jsx)(n.code,{children:"gSettings.heater.sleep_timeout_ms"}),". Default values are 5, 10, and 15 minutes respectively."]})}),"\n",(0,r.jsx)(n.h3,{id:"pump--motor",children:"Pump & Motor"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pin"}),(0,r.jsx)(n.th,{children:"GPIO"}),(0,r.jsx)(n.th,{children:"Function"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_PUMP_TRIGGER_PIN"})}),(0,r.jsx)(n.td,{children:"15"}),(0,r.jsx)(n.td,{children:"Trigger input"}),(0,r.jsx)(n.td,{children:"Active low, internal pullup"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_MOTOR_IN1_PIN"})}),(0,r.jsx)(n.td,{children:"2"}),(0,r.jsx)(n.td,{children:"Motor driver IN1"}),(0,r.jsx)(n.td,{children:"H-bridge control"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_MOTOR_IN2_PIN"})}),(0,r.jsx)(n.td,{children:"3"}),(0,r.jsx)(n.td,{children:"Motor driver IN2"}),(0,r.jsx)(n.td,{children:"H-bridge control"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"display-spi",children:"Display (SPI)"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pin"}),(0,r.jsx)(n.th,{children:"GPIO"}),(0,r.jsx)(n.th,{children:"Function"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_DISPLAY_CS"})}),(0,r.jsx)(n.td,{children:"17"}),(0,r.jsx)(n.td,{children:"Chip select"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_DISPLAY_DC"})}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Data/Command"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_DISPLAY_RST"})}),(0,r.jsx)(n.td,{children:"21"}),(0,r.jsx)(n.td,{children:"Reset"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_DISPLAY_SCK"})}),(0,r.jsx)(n.td,{children:"18"}),(0,r.jsx)(n.td,{children:"SPI clock"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_DISPLAY_MOSI"})}),(0,r.jsx)(n.td,{children:"19"}),(0,r.jsx)(n.td,{children:"SPI data"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"encoder",children:"Encoder"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pin"}),(0,r.jsx)(n.th,{children:"GPIO"}),(0,r.jsx)(n.th,{children:"Function"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_ENCODER_A"})}),(0,r.jsx)(n.td,{children:"12"}),(0,r.jsx)(n.td,{children:"Encoder A channel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_ENCODER_B"})}),(0,r.jsx)(n.td,{children:"13"}),(0,r.jsx)(n.td,{children:"Encoder B channel"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_ENCODER_SW"})}),(0,r.jsx)(n.td,{children:"14"}),(0,r.jsx)(n.td,{children:"Encoder switch"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"motion-sensor",children:"Motion Sensor"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pin"}),(0,r.jsx)(n.th,{children:"GPIO"}),(0,r.jsx)(n.th,{children:"Function"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"CONFIG_MOTION_INT"})}),(0,r.jsx)(n.td,{children:"22"}),(0,r.jsx)(n.td,{children:"Interrupt output"})]})})]}),"\n",(0,r.jsx)(n.h2,{id:"rtos-task-configuration",children:"RTOS Task Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",metastring:'title="include/config.h"',children:"// Heater control task\n#define CONFIG_HEATER_TASK_STACK_SIZE  4096\n#define CONFIG_HEATER_TASK_PRIORITY    (configMAX_PRIORITIES - 1)\n#define CONFIG_HEATER_TASK_CORE        0x01  // Core 0\n\n// Pump control task  \n#define CONFIG_PUMP_TASK_STACK_SIZE    2048\n#define CONFIG_PUMP_TASK_PRIORITY      (configMAX_PRIORITIES - 2)\n#define CONFIG_PUMP_TASK_CORE          0x02  // Core 1\n\n// LVGL task\n#define CONFIG_LVGL_TASK_STACK_SIZE    8192\n#define CONFIG_LVGL_TASK_PRIORITY      (configMAX_PRIORITIES - 2)\n#define CONFIG_LVGL_TASK_CORE          0x02  // Core 1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"settings-structure",children:"Settings Structure"}),"\n",(0,r.jsxs)(n.p,{children:["Runtime configuration stored in ",(0,r.jsx)(n.code,{children:"gSettings"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",metastring:'title="include/settings.h"',children:"struct Settings {\n    struct {\n        uint16_t target_temperature;      // Default: 350\xb0C\n        uint8_t  standby_temperature;     // Default: 200\xb0C\n        uint16_t standby_timeout_sec;     // Default: 60s\n        uint16_t sleep_timeout_sec;       // Default: 300s\n        struct {\n            float kp, ki, kd;             // PID gains\n            float imax, imin;             // Integral limits\n        } pid;\n    } heater;\n    \n    struct {\n        uint8_t  speed_percent;           // Default: 100%\n        uint16_t acceleration_ms;         // Default: 500ms\n    } pump;\n    \n    struct {\n        uint8_t  brightness;              // Default: 80%\n        bool     dark_mode;               // Default: true\n    } display;\n};\n\nextern Settings gSettings;\nextern SemaphoreHandle_t gSettingsMutex;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"settings-persistence",children:"Settings Persistence"}),"\n",(0,r.jsxs)(n.p,{children:["Settings are stored in ",(0,r.jsx)(n.code,{children:"/settings.json"})," on LittleFS:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="data/settings.json"',children:'{\n  "heater": {\n    "target_temperature": 350,\n    "standby_temperature": 200,\n    "standby_timeout": 60,\n    "sleep_timeout": 300,\n    "pid": {\n      "kp": 1.0,\n      "ki": 0.8,\n      "kd": 3.5,\n      "imax": 5.0,\n      "imin": 0.0\n    }\n  },\n  "pump": {\n    "speed": 100,\n    "acceleration": 500\n  },\n  "display": {\n    "brightness": 80,\n    "dark_mode": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"build-configuration",children:"Build Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"platformio-environment",children:"PlatformIO Environment"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",metastring:'title="platformio.ini"',children:"[env:desoldering-station-rev3]\nplatform = https://github.com/maxgerhardt/platform-raspberrypi.git\nboard = rpipico\nframework = arduino\n\n; FreeRTOS SMP\nboard_build.core = earlephilhower\nbuild_flags = \n    -DUSE_FREERTOS\n    -DCONFIG_FREERTOS_UNICORE=0\n    \n; LittleFS partition\nboard_build.filesystem_size = 0.5m\n\n; Upload settings\nupload_protocol = picotool\nmonitor_speed = 115200\n"})}),"\n",(0,r.jsx)(n.h3,{id:"build-commands",children:"Build Commands"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Build only\npio run -e desoldering-station-rev3\n\n# Build and upload\npio run -e desoldering-station-rev3 -t upload\n\n# Upload filesystem\npio run -e desoldering-station-rev3 -t uploadfs\n\n# Clean build\npio run -e desoldering-station-rev3 -t clean\n\n# Debug build\npio debug -e desoldering-station-rev3\n"})}),"\n",(0,r.jsx)(n.h2,{id:"pwm-configuration",children:"PWM Configuration"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Heater PWM frequency"}),(0,r.jsx)(n.td,{children:"25 kHz"}),(0,r.jsx)(n.td,{children:"Reduces audible noise"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Motor PWM frequency"}),(0,r.jsx)(n.td,{children:"20 kHz"}),(0,r.jsx)(n.td,{children:"Standard for DC motors"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PWM resolution"}),(0,r.jsx)(n.td,{children:"16-bit"}),(0,r.jsx)(n.td,{children:"RP2040 native"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"adc-configuration",children:"ADC Configuration"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Resolution"}),(0,r.jsx)(n.td,{children:"12-bit"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sample rate"}),(0,r.jsx)(n.td,{children:"500 ksps max"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Reference"}),(0,r.jsx)(n.td,{children:"3.3V internal"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Averaging"}),(0,r.jsx)(n.td,{children:"16 samples"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);