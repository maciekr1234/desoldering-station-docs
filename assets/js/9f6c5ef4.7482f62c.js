"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[1331],{3191:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"gui/menu-structure","title":"Menu Structure","description":"This document describes the hierarchical structure of the settings menu and the temperature calibration wizard.","source":"@site/docs/gui/menu-structure.md","sourceDirName":"gui","slug":"/gui/menu-structure","permalink":"/desoldering-station-docs/docs/gui/menu-structure","draft":false,"unlisted":false,"editUrl":"https://github.com/maciekr1234/desoldering-station/tree/master/docs-site/docs/gui/menu-structure.md","tags":[],"version":"current","lastUpdatedAt":1764775533000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Settings Menu Widget","permalink":"/desoldering-station-docs/docs/gui/lv-settings-menu"},"next":{"title":"API Reference","permalink":"/desoldering-station-docs/docs/api"}}');var r=n(4848),a=n(8453);const s={},l="Menu Structure",d={},c=[{value:"Menu Hierarchy",id:"menu-hierarchy",level:2},{value:"Page Descriptions",id:"page-descriptions",level:2},{value:"Heater Settings",id:"heater-settings",level:3},{value:"Calibration",id:"calibration",level:3},{value:"Temperature Calibration",id:"temperature-calibration",level:4},{value:"PID Tuning",id:"pid-tuning",level:4},{value:"Pump Settings",id:"pump-settings",level:3},{value:"System",id:"system",level:3},{value:"Debug",id:"debug",level:3},{value:"Temperature Calibration Wizard",id:"temperature-calibration-wizard",level:2},{value:"State Diagram",id:"state-diagram",level:3},{value:"Calibration Process",id:"calibration-process",level:3},{value:"Calibration Points",id:"calibration-points",level:3},{value:"Timing Parameters",id:"timing-parameters",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"API Integration",id:"api-integration",level:2},{value:"HeaterController Methods Used",id:"heatercontroller-methods-used",level:3},{value:"Settings Structure",id:"settings-structure",level:3},{value:"UI Subjects",id:"ui-subjects",level:3}];function o(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"menu-structure",children:"Menu Structure"})}),"\n",(0,r.jsx)(t.p,{children:"This document describes the hierarchical structure of the settings menu and the temperature calibration wizard."}),"\n",(0,r.jsx)(t.h2,{id:"menu-hierarchy",children:"Menu Hierarchy"}),"\n",(0,r.jsx)(t.mermaid,{value:'graph TD\n    subgraph Root["Settings Menu"]\n        A[Settings]\n    end\n\n    subgraph Pages["Main Pages"]\n        A --\x3e B[Heater]\n        A --\x3e C[Calibration]\n        A --\x3e D[Pump Settings]\n        A --\x3e E[System]\n        A --\x3e F[Debug]\n        A --\x3e G[Exit]\n    end\n\n    subgraph Calibration["Calibration Subpages"]\n        C --\x3e C1[Temperature Calibration]\n        C --\x3e C2[PID Tuning]\n    end\n\n    subgraph TempCal["Temperature Calibration States"]\n        C1 --\x3e TC1[Idle - Preview & Start]\n        TC1 --\x3e TC2[Calibration Wizard]\n        TC2 --\x3e TC3[Complete - Results]\n    end\n\n    subgraph PID["PID Tuning Controls"]\n        C2 --\x3e P1[Kp - Proportional]\n        C2 --\x3e P2[Ki - Integral]\n        C2 --\x3e P3[Kd - Derivative]\n        C2 --\x3e P4[I-Max]\n        C2 --\x3e P5[I-Min]\n        C2 --\x3e P6[Apply Button]\n        C2 --\x3e P7[Save to Flash]\n    end'}),"\n",(0,r.jsx)(t.h2,{id:"page-descriptions",children:"Page Descriptions"}),"\n",(0,r.jsx)(t.h3,{id:"heater-settings",children:"Heater Settings"}),"\n",(0,r.jsx)(t.p,{children:"Basic heater configuration options:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Default Temperature"}),": Starting temperature when heater is activated"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Standby Temperature"}),": Temperature maintained during standby mode"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"calibration",children:"Calibration"}),"\n",(0,r.jsx)(t.p,{children:"Contains two subpages for temperature and PID calibration."}),"\n",(0,r.jsx)(t.h4,{id:"temperature-calibration",children:"Temperature Calibration"}),"\n",(0,r.jsx)(t.p,{children:"A guided wizard for calibrating temperature sensor readings at 6 fixed points (100\xb0C, 200\xb0C, 300\xb0C, 350\xb0C, 400\xb0C, 450\xb0C)."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Features:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Preview of current calibration values before starting"}),"\n",(0,r.jsx)(t.li,{children:"Real-time temperature display during calibration"}),"\n",(0,r.jsx)(t.li,{children:"Stability detection (\xb15\xb0C for 2 seconds) before allowing input"}),"\n",(0,r.jsx)(t.li,{children:"5-minute timeout per step with automatic cooldown"}),"\n",(0,r.jsx)(t.li,{children:"Cancel confirmation dialog"}),"\n",(0,r.jsx)(t.li,{children:"Input validation (target \xb150\xb0C range)"}),"\n",(0,r.jsx)(t.li,{children:"Results summary with Save/Start Over/Exit options"}),"\n"]}),"\n",(0,r.jsx)(t.h4,{id:"pid-tuning",children:"PID Tuning"}),"\n",(0,r.jsx)(t.p,{children:"Adjust PID controller parameters for heater temperature control:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Kp (Proportional)"}),": Controls response speed (0-100, 2 decimal places)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Ki (Integral)"}),": Eliminates steady-state error (0-10, 2 decimal places)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Kd (Derivative)"}),": Reduces overshoot (0-50, 1 decimal place)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"I-Max"}),": Maximum integral term limit (0-100)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"I-Min"}),": Minimum integral term limit (-100 to 0)"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Actions:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Apply"}),": Applies values to heater immediately (not saved)"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Save to Flash"}),": Applies values and persists to settings file"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"pump-settings",children:"Pump Settings"}),"\n",(0,r.jsx)(t.p,{children:"Configuration options for the vacuum pump (placeholder)."}),"\n",(0,r.jsx)(t.h3,{id:"system",children:"System"}),"\n",(0,r.jsx)(t.p,{children:"System-wide settings (placeholder)."}),"\n",(0,r.jsx)(t.h3,{id:"debug",children:"Debug"}),"\n",(0,r.jsx)(t.p,{children:"Debug and diagnostic options (placeholder)."}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"temperature-calibration-wizard",children:"Temperature Calibration Wizard"}),"\n",(0,r.jsx)(t.h3,{id:"state-diagram",children:"State Diagram"}),"\n",(0,r.jsx)(t.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Idle: Page opened\n\n    Idle --\x3e Heating: Start Calibration clicked\n    \n    Heating --\x3e Stabilizing: Temperature within \xb15\xb0C\n    Stabilizing --\x3e Heating: Temperature drifts outside \xb15\xb0C\n    Stabilizing --\x3e WaitingInput: Stable for 2 seconds\n    \n    WaitingInput --\x3e Heating: Confirm clicked\\n(next step)\n    WaitingInput --\x3e Complete: Confirm clicked\\n(step 6 done)\n    \n    Heating --\x3e Timeout: 5 minutes elapsed\n    Stabilizing --\x3e Timeout: 5 minutes elapsed\n    WaitingInput --\x3e Timeout: 5 minutes elapsed\n    \n    Timeout --\x3e [*]: Heater off, exit after 2s\n    \n    Heating --\x3e [*]: Cancel confirmed\n    Stabilizing --\x3e [*]: Cancel confirmed\n    WaitingInput --\x3e [*]: Cancel confirmed\n    \n    Complete --\x3e Idle: Start Over clicked\n    Complete --\x3e [*]: Save clicked\n    Complete --\x3e [*]: Exit clicked"}),"\n",(0,r.jsx)(t.h3,{id:"calibration-process",children:"Calibration Process"}),"\n",(0,r.jsx)(t.mermaid,{value:'sequenceDiagram\n    participant User\n    participant UI as Calibration UI\n    participant Heater as HeaterController\n    participant Settings as gSettings\n\n    User->>UI: Open Temperature Calibration\n    UI->>UI: Show current values preview\n    \n    User->>UI: Click "Start Calibration"\n    UI->>Heater: changeState(Tuning)\n    UI->>Heater: setTargetTemperature(100)\n    UI->>UI: Create 200ms timer\n    \n    loop For each step (100, 200, 300, 350, 400, 450\xb0C)\n        UI->>UI: Display "Heating..."\n        \n        loop Until stable\n            UI->>UI: Timer: Read temperature\n            UI->>UI: Check \xb15\xb0C threshold\n        end\n        \n        UI->>UI: Display "Stabilizing..."\n        \n        loop 2 seconds\n            UI->>UI: Timer: Verify stability\n        end\n        \n        UI->>UI: Display "Ready"\n        UI->>UI: Enable input & Confirm\n        \n        User->>UI: Enter measured temperature\n        User->>UI: Click "Confirm"\n        UI->>UI: Store value, advance step\n        UI->>Heater: setTargetTemperature(next)\n    end\n    \n    UI->>Heater: changeState(Off)\n    UI->>UI: Show results summary\n    \n    alt Save\n        User->>UI: Click "Save"\n        UI->>Settings: Update calibration values\n        UI->>Settings: save_global_settings()\n        UI->>UI: Show "Saved!" toast\n    else Exit\n        User->>UI: Click "Exit"\n    end\n    \n    UI->>UI: Return to menu'}),"\n",(0,r.jsx)(t.h3,{id:"calibration-points",children:"Calibration Points"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Step"}),(0,r.jsx)(t.th,{children:"Target Temperature"}),(0,r.jsx)(t.th,{children:"Input Range"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"1"}),(0,r.jsx)(t.td,{children:"100\xb0C"}),(0,r.jsx)(t.td,{children:"50-150\xb0C"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"2"}),(0,r.jsx)(t.td,{children:"200\xb0C"}),(0,r.jsx)(t.td,{children:"150-250\xb0C"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"3"}),(0,r.jsx)(t.td,{children:"300\xb0C"}),(0,r.jsx)(t.td,{children:"250-350\xb0C"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"4"}),(0,r.jsx)(t.td,{children:"350\xb0C"}),(0,r.jsx)(t.td,{children:"300-400\xb0C"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"5"}),(0,r.jsx)(t.td,{children:"400\xb0C"}),(0,r.jsx)(t.td,{children:"350-450\xb0C"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"6"}),(0,r.jsx)(t.td,{children:"450\xb0C"}),(0,r.jsx)(t.td,{children:"400-500\xb0C"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"timing-parameters",children:"Timing Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Value"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Stability Threshold"}),(0,r.jsx)(t.td,{children:"\xb15\xb0C"}),(0,r.jsx)(t.td,{children:"Temperature must be within this range of target"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Stability Duration"}),(0,r.jsx)(t.td,{children:"2 seconds"}),(0,r.jsx)(t.td,{children:"Time temperature must remain stable"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Step Timeout"}),(0,r.jsx)(t.td,{children:"5 minutes"}),(0,r.jsx)(t.td,{children:"Maximum time allowed to reach and stabilize"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Cooldown Delay"}),(0,r.jsx)(t.td,{children:"2 seconds"}),(0,r.jsx)(t.td,{children:"Delay before exit after timeout"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Timer Interval"}),(0,r.jsx)(t.td,{children:"200ms"}),(0,r.jsx)(t.td,{children:"UI update frequency during calibration"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Timeout"}),": If temperature doesn't stabilize within 5 minutes, the heater is turned off and the user is returned to the menu after a 2-second cooldown message."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Cancel"}),": User can cancel at any time. A confirmation dialog prevents accidental cancellation. Progress is lost on cancel."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Input Validation"}),": Measured temperature input is clamped to target \xb150\xb0C to prevent obvious entry errors."]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"api-integration",children:"API Integration"}),"\n",(0,r.jsx)(t.h3,{id:"heatercontroller-methods-used",children:"HeaterController Methods Used"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"// State control\ngHeater.changeState(HeaterState::Tuning);  // Enter calibration mode\ngHeater.changeState(HeaterState::Off);     // Stop heater\n\n// Temperature control\ngHeater.setTargetTemperature(uint16_t temp);\n\n// PID control\ngHeater.setPID(float kp, float ki, float kd, float imax, float imin);\npid_ctrl_parameter_t gHeater.getPIDParameters();\n"})}),"\n",(0,r.jsx)(t.h3,{id:"settings-structure",children:"Settings Structure"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"// Temperature calibration values\ngSettings.heater.calibration.at100  // Measured temp at 100\xb0C target\ngSettings.heater.calibration.at200  // Measured temp at 200\xb0C target\ngSettings.heater.calibration.at300  // Measured temp at 300\xb0C target\ngSettings.heater.calibration.at350  // Measured temp at 350\xb0C target\ngSettings.heater.calibration.at400  // Measured temp at 400\xb0C target\ngSettings.heater.calibration.at450  // Measured temp at 450\xb0C target\n\n// PID parameters\ngSettings.heater.pid.kp    // Proportional gain\ngSettings.heater.pid.ki    // Integral gain\ngSettings.heater.pid.kd    // Derivative gain\ngSettings.heater.pid.imax  // Max integral limit\ngSettings.heater.pid.imin  // Min integral limit\n"})}),"\n",(0,r.jsx)(t.h3,{id:"ui-subjects",children:"UI Subjects"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-cpp",children:"// Real-time temperature (updated by heater task)\nextern lv_subject_t ui_subject_heater_temperature;\n"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var i=n(6540);const r={},a=i.createContext(r);function s(e){const t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);